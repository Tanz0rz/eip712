import { _TypedDataEncoder } from '@ethersproject/hash';
import {Interface} from "@ethersproject/abi";

const abi = require('./safe-snap-abi.json');

const tx = {
    to: "0x60AF6197d08dEa71A22581f13B72018B8C2671A7",
    value: "34000000000000000",
    data: "0x",
    /// @param operation Operation type of module transaction: 0 == call, 1 == delegate call.
    operation: "0",
    nonce: "0"
};

const EIP712_TYPES = {
    Transaction: [
        {
            name: 'to',
            type: 'address'
        },
        {
            name: 'value',
            type: 'uint256'
        },
        {
            name: 'data',
            type: 'bytes'
        },
        {
            name: 'operation',
            type: 'uint8'
        },
        {
            name: 'nonce',
            type: 'uint256'
        }
    ]
};

const domain = {
    chainId: 4,
    verifyingContract: '0xe97253Ad60F66f7B359615FF7aB7Ecd9CD37fE1C'
};

const proposalId = '0x8e4963330cbc3377729231f9ff8d6ead8a6dfb10e520786a31ae4ae68412cd8b';

const iface = new Interface(abi);
const encodedData = '0x14604b8c00000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000016000000000000000000000000060af6197d08dea71a22581f13b72018b8c2671a7000000000000000000000000000000000000000000000000002386f26fc1000000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000423078633166633463336262363762303036653364363834393833623935663461326539306463313139323235653264613732346533363331316266346663653863620000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001bd2d163d4cfb5e4a12b123c9b11afeb353d42c4cc9b8a66c1472c88b9798c20c0000000000000000000000000000000000000000000000000000000000000000';
const data = iface.decodeFunctionData('executeProposalWithIndex', encodedData);

console.log('decoded: ', data);

// https://snapshot.org/#/bitdecay.eth/proposal/0x8e4963330cbc3377729231f9ff8d6ead8a6dfb10e520786a31ae4ae68412cd8b
